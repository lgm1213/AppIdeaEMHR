<div class="mb-8 flex items-center justify-between">
  <div>
    <%= link_to "â† Back to Practices", admin_organizations_path, 
      class: "text-sm text-indigo-600 hover:text-indigo-500 font-medium mb-1 inline-block" 
    %>
    <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight">
      <%= @organization.name %>
    </h2>
    <div class="flex items-center gap-3 mt-1">
      <p class="text-sm text-gray-500">Slug: <code class="bg-gray-100 px-1 py-0.5 rounded text-gray-700 font-mono text-xs">/<%= @organization.slug %></code></p>
      
      <% if @organization.try(:plan).present? %>
        <span class="inline-flex items-center rounded-md bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700 ring-1 ring-inset ring-blue-700/10 uppercase tracking-wide">
          <%= @organization.plan %>
        </span>
      <% end %>
    </div>
  </div>

  <div>
    <%= link_to "Edit Settings", edit_admin_organization_path(@organization), 
      class: %w[
        rounded-md bg-white px-3 py-2 
        text-sm font-semibold text-gray-900 shadow-sm 
        ring-1 ring-inset ring-gray-300 
        hover:bg-gray-50
      ].join(" ")
    %>
  </div>
</div>

<div class="grid grid-cols-1 gap-10 md:grid-cols-2">
  
  <div class="bg-white shadow sm:rounded-lg border border-gray-200">
    <div class="px-4 py-5 sm:px-6 border-b border-gray-200 bg-gray-50 flex justify-between items-center">
      <h3 class="text-base font-semibold leading-6 text-gray-900">Facilities</h3>
      
      <%= link_to "Add Facility", new_admin_organization_facility_path(@organization), 
        class: "rounded bg-white px-2 py-1 text-xs font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" 
      %>
    </div>
    <ul role="list" class="divide-y divide-gray-200">
      <% @facilities.each do |facility| %>
        <li class="relative px-4 py-4 hover:bg-gray-50 transition">
          <div class="flex items-center justify-between">
            <div>
              <%= link_to facility.name, admin_organization_facility_path(@organization, facility), 
                class: "text-sm font-medium text-indigo-600 truncate hover:underline focus:outline-none" 
              %>
              <div class="text-sm text-gray-500"><%= facility.address rescue "No address" %></div>
            </div>
            
            <svg class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor">
               <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
            </svg>
          </div>
          <%= link_to "", admin_organization_facility_path(@organization, facility), 
            class: "absolute inset-0", "aria-hidden": "true" 
          %>
        </li>
      <% end %>
      <% if @facilities.empty? %>
        <li class="px-4 py-8 text-center text-sm text-gray-500 italic">No facilities configured.</li>
      <% end %>
    </ul>
  </div>

  <div class="bg-white shadow sm:rounded-lg border border-gray-200">
    <div class="px-4 py-5 sm:px-6 border-b border-gray-200 bg-gray-50 flex justify-between items-center">
      <h3 class="text-base font-semibold leading-6 text-gray-900">Staff & Roles</h3>

      <%= link_to "Add User", new_admin_organization_user_path(@organization), 
        class: "rounded bg-white px-2 py-1 text-xs font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50" 
      %>
    </div>
    <ul role="list" class="divide-y divide-gray-200">
      <% @users.each do |user| %>
        <li class="relative hover:bg-gray-50 transition">
          <div class="px-4 py-4">
            <div class="flex items-center justify-between">
              <div class="flex items-center gap-3">
                <div class="h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center text-gray-600 font-bold text-xs">
                  <%= user.initials %>
                </div>
                <div>
                  <%= link_to user.full_name, admin_user_path(user), 
                    class: "text-sm font-medium text-indigo-600 hover:underline focus:outline-none" 
                  %>
                  <p class="text-xs text-gray-500"><%= user.email_address %></p>
                </div>
              </div>
              <div class="flex items-center gap-4">
                <span class="inline-flex items-center rounded-md bg-green-50 px-2 py-1 text-xs font-medium text-green-700 ring-1 ring-inset ring-green-600/20">
                  <%= user.role.humanize %>
                </span>
                <svg class="h-5 w-5 text-gray-400" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                  <path fill-rule="evenodd" d="M7.21 14.77a.75.75 0 01.02-1.06L11.168 10 7.23 6.29a.75.75 0 111.04-1.08l4.5 4.25a.75.75 0 010 1.08l-4.5 4.25a.75.75 0 01-1.06-.02z" clip-rule="evenodd" />
                </svg>
              </div>
            </div>
            <%= link_to "", admin_user_path(user), 
              class: "absolute inset-0", "aria-hidden": "true" 
            %>
          </div>
        </li>
      <% end %>
       <% if @users.empty? %>
        <li class="px-4 py-8 text-center text-sm text-gray-500 italic">No users found.</li>
      <% end %>
    </ul>
  </div>
  
</div>